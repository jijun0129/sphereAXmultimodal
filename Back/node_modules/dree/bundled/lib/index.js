!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define("dree",[],r):"object"==typeof exports?exports.dree=r():e.dree=r()}(this,(function(){return(()=>{"use strict";var e={183:function(e,r,t){var n=this&&this.__awaiter||function(e,r,t,n){return new(t||(t=Promise))((function(s,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var r;e.done?s(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(o,a)}c((n=n.apply(e,r||[])).next())}))},s=this&&this.__generator||function(e,r){var t,n,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(s=2&i[0]?n.return:i[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,i[1])).done)return s;switch(n=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!((s=(s=o.trys).length>0&&s[s.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=r.call(e,o)}catch(e){i=[6,e],n=0}finally{t=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(r,"__esModule",{value:!0}),r.parseTreeAsync=r.parseTree=r.parseAsync=r.parse=r.scanAsync=r.scan=r.Type=void 0;var i,o=t(17),a=t(113),c=t(147),l=t(837),u=(0,l.promisify)(c.stat),h=(0,l.promisify)(c.readdir),f=(0,l.promisify)(c.readFile),d=(0,l.promisify)(c.lstat);!function(e){e.DIRECTORY="directory",e.FILE="file"}(i=r.Type||(r.Type={}));var p={stat:!1,normalize:!1,symbolicLinks:!0,followLinks:!1,sizeInBytes:!0,size:!0,hash:!0,hashAlgorithm:"md5",hashEncoding:"hex",showHidden:!0,depth:void 0,exclude:void 0,matches:void 0,extensions:void 0,emptyDirectory:!1,excludeEmptyDirectories:!1,sorted:!1,skipErrors:!0},y={symbolicLinks:!0,followLinks:!1,showHidden:!0,depth:void 0,exclude:void 0,extensions:void 0,sorted:!1,skipErrors:!0};function v(e){var r={};if(e){for(var t in p)r[t]=void 0!==e[t]?e[t]:p[t];r.depth<0&&(r.depth=0)}else r=p;return r}function m(e){var r={};if(e){for(var t in y)r[t]=void 0!==e[t]?e[t]:y[t];r.depth<0&&(r.depth=0)}else r=y;return r}function b(e){var r,t=["B","KB","MB","GB","TB"];for(r=0;r<t.length&&e>1e3;r++)e/=1e3;return Math.round(100*e)/100+" "+t[r]}function x(e,r,t,n,s,l){if(void 0!==n.depth&&t>n.depth)return null;if(n.exclude&&e!==r&&(n.exclude instanceof RegExp?[n.exclude]:n.exclude).some((function(e){return e.test(r)})))return null;var u,h,f=e===r?".":(0,o.relative)(e,r),d=(0,o.basename)(r);try{u=(0,c.statSync)(r)}catch(e){if(n.skipErrors)return null;throw e}try{h=(0,c.lstatSync)(r)}catch(e){if(n.skipErrors)return null;throw e}var p,y=h.isSymbolicLink(),v=u.isFile()?i.FILE:i.DIRECTORY;if(!n.showHidden&&"."===d.charAt(0))return null;if(!n.symbolicLinks&&y)return null;if(n.hash){var m=n.hashAlgorithm;(p=(0,a.createHash)(m)).update(d)}var E={name:d,path:n.normalize?r.replace(/\\/g,"/"):r,relativePath:n.normalize?f.replace(/\\/g,"/"):f,type:v,isSymbolicLink:y,stat:n.followLinks?u:h};switch(n.stat||delete E.stat,v){case i.DIRECTORY:var k=[],w=void 0;if(n.followLinks||!y){try{w=(0,c.readdirSync)(r),n.sorted&&(w="boolean"==typeof n.sorted?w.sort():w.sort(n.sorted))}catch(e){if(n.skipErrors)return null;throw e}if(n.emptyDirectory&&(E.isEmpty=!w.length),w.forEach((function(i){var a=x(e,(0,o.resolve)(r,i),t+1,n,s,l);null!==a&&k.push(a)})),n.excludeEmptyDirectories&&!k.length)return null}if(n.matches&&e!==r){var g=n.matches instanceof RegExp?[n.matches]:n.matches;if(!k.length&&g.some((function(e){return!e.test(r)})))return null}if(n.sizeInBytes||n.size){var L=k.reduce((function(e,r){return e+r.sizeInBytes}),0);E.sizeInBytes=L,E.size=n.size?b(L):void 0,n.sizeInBytes||k.forEach((function(e){return e.sizeInBytes=void 0}))}if(n.hash){k.forEach((function(e){p.update(e.hash)}));var I=n.hashEncoding;E.hash=p.digest(I)}k.length&&(E.children=k);break;case i.FILE:if(E.extension=(0,o.extname)(r).replace(".",""),n.extensions&&-1===n.extensions.indexOf(E.extension))return null;if(n.matches&&e!==r&&(g=n.matches instanceof RegExp?[n.matches]:n.matches).some((function(e){return!e.test(r)})))return null;if((n.sizeInBytes||n.size)&&(L=n.followLinks?u.size:h.size,E.sizeInBytes=L,E.size=n.size?b(L):void 0),n.hash){var z=void 0;try{z=(0,c.readFileSync)(r)}catch(e){if(n.skipErrors)return null;throw e}p.update(z),I=n.hashEncoding,E.hash=p.digest(I)}break;default:return null}return s&&v===i.FILE?s(E,n.followLinks?u:h):l&&v===i.DIRECTORY&&l(E,n.followLinks?u:h),E}function E(e,r,t,c,l,p){return n(this,void 0,void 0,(function(){var y,v,m,x,k,w,g,L,I,z,R,B,S,T,D,O,F,C,A,Y=this;return s(this,(function(P){switch(P.label){case 0:if(void 0!==c.depth&&t>c.depth)return[2,null];if(c.exclude&&e!==r&&(c.exclude instanceof RegExp?[c.exclude]:c.exclude).some((function(e){return e.test(r)})))return[2,null];y=e===r?".":(0,o.relative)(e,r),v=(0,o.basename)(r),P.label=1;case 1:return P.trys.push([1,3,,4]),[4,u(r)];case 2:return m=P.sent(),[3,4];case 3:if(x=P.sent(),c.skipErrors)return[2,null];throw x;case 4:return P.trys.push([4,6,,7]),[4,d(r)];case 5:return k=P.sent(),[3,7];case 6:if(w=P.sent(),c.skipErrors)return[2,null];throw w;case 7:if(g=k.isSymbolicLink(),L=m.isFile()?i.FILE:i.DIRECTORY,!c.showHidden&&"."===v.charAt(0))return[2,null];if(!c.symbolicLinks&&g)return[2,null];switch(c.hash&&(z=c.hashAlgorithm,(I=(0,a.createHash)(z)).update(v)),R={name:v,path:c.normalize?r.replace(/\\/g,"/"):r,relativePath:c.normalize?y.replace(/\\/g,"/"):y,type:L,isSymbolicLink:g,stat:c.followLinks?m:k},c.stat||delete R.stat,L){case i.DIRECTORY:return[3,8];case i.FILE:return[3,15]}return[3,21];case 8:if(B=[],S=void 0,!c.followLinks&&g)return[3,14];P.label=9;case 9:return P.trys.push([9,11,,12]),[4,h(r)];case 10:return S=P.sent(),c.sorted&&(S="boolean"==typeof c.sorted?S.sort():S.sort(c.sorted)),[3,12];case 11:if(T=P.sent(),c.skipErrors)return[2,null];throw T;case 12:return c.emptyDirectory&&(R.isEmpty=!S.length),[4,Promise.all(S.map((function(i){return n(Y,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return[4,E(e,(0,o.resolve)(r,i),t+1,c,l,p)];case 1:return[2,n.sent()]}}))}))})))];case 13:if(B=(B=P.sent()).filter((function(e){return null!==e})),c.excludeEmptyDirectories&&!B.length)return[2,null];P.label=14;case 14:return c.matches&&e!==r&&(D=c.matches instanceof RegExp?[c.matches]:c.matches,!B.length&&D.some((function(e){return!e.test(r)})))?[2,null]:((c.sizeInBytes||c.size)&&(O=B.reduce((function(e,r){return e+r.sizeInBytes}),0),R.sizeInBytes=O,R.size=c.size?b(O):void 0,c.sizeInBytes||B.forEach((function(e){return e.sizeInBytes=void 0}))),c.hash&&(B.forEach((function(e){I.update(e.hash)})),A=c.hashEncoding,R.hash=I.digest(A)),B.length&&(R.children=B),[3,22]);case 15:if(R.extension=(0,o.extname)(r).replace(".",""),c.extensions&&-1===c.extensions.indexOf(R.extension))return[2,null];if(c.matches&&e!==r&&(D=c.matches instanceof RegExp?[c.matches]:c.matches).some((function(e){return!e.test(r)})))return[2,null];if((c.sizeInBytes||c.size)&&(O=c.followLinks?m.size:k.size,R.sizeInBytes=O,R.size=c.size?b(O):void 0),!c.hash)return[3,20];F=void 0,P.label=16;case 16:return P.trys.push([16,18,,19]),[4,f(r)];case 17:return F=P.sent(),[3,19];case 18:if(C=P.sent(),c.skipErrors)return[2,null];throw C;case 19:I.update(F),A=c.hashEncoding,R.hash=I.digest(A),P.label=20;case 20:return[3,22];case 21:return[2,null];case 22:return l&&L===i.FILE?[4,l(R,c.followLinks?m:k)]:[3,24];case 23:return P.sent(),[3,26];case 24:return p&&L===i.DIRECTORY?[4,p(R,c.followLinks?m:k)]:[3,26];case 25:P.sent(),P.label=26;case 26:return[2,R]}}))}))}function k(e,r,t){return!r.symbolicLinks&&e.isSymbolicLink||!r.showHidden&&"."===e.name.charAt(0)||void 0!==r.extensions&&e.type===i.FILE&&-1===r.extensions.indexOf(e.extension)||r.exclude instanceof RegExp&&r.exclude.test(e.path)||Array.isArray(r.exclude)&&r.exclude.some((function(r){return r.test(e.path)}))||void 0!==r.depth&&t>r.depth}function w(e,r,t,n){var s="",a=e.map((function(s,a){var l="";if(void 0!==t.depth&&n>t.depth)return"";if(t.exclude&&(t.exclude instanceof RegExp?[t.exclude]:t.exclude).some((function(e){return e.test(s)})))return"";var u,h,f=(0,o.basename)(s);try{u=(0,c.statSync)(s)}catch(e){if(t.skipErrors)return null;throw e}try{h=(0,c.lstatSync)(s)}catch(e){if(t.skipErrors)return null;throw e}var d=h.isSymbolicLink(),p=u.isFile()?i.FILE:i.DIRECTORY;if(!t.showHidden&&"."===f.charAt(0))return"";if(!t.symbolicLinks&&d)return"";var y=(0,o.extname)(s).replace(".","");if(t.extensions&&p===i.FILE&&-1===t.extensions.indexOf(y))return"";var v=d?">>":p===i.DIRECTORY?"─> ":"── ",m=r+(a===e.length-1?"    ":"│   ");if(l+=v+f,(t.followLinks||!d)&&p===i.DIRECTORY){var b;try{b=(0,c.readdirSync)(s).map((function(e){return(0,o.resolve)(s,e)})),t.sorted&&(b="boolean"==typeof t.sorted?b.sort():b.sort(t.sorted))}catch(e){if(t.skipErrors)return null;throw e}l+=b.length?w(b,m,t,n+1):""}return l}));return a.filter((function(e){return!!e})).forEach((function(e,t,n){s+=r+(t===n.length-1?"└"+e:"├"+e)})),s}function g(e,r,t,a){return n(this,void 0,void 0,(function(){var c,l=this;return s(this,(function(f){switch(f.label){case 0:return c="",[4,Promise.all(e.map((function(c,f){return n(l,void 0,void 0,(function(){var n,l,p,y,v,m,b,x,E,k,w,L,I,z,R;return s(this,(function(s){switch(s.label){case 0:if(n="",void 0!==t.depth&&a>t.depth)return[2,""];if(t.exclude&&(t.exclude instanceof RegExp?[t.exclude]:t.exclude).some((function(e){return e.test(c)})))return[2,""];l=(0,o.basename)(c),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,u(c)];case 2:return p=s.sent(),[3,4];case 3:if(y=s.sent(),t.skipErrors)return[2,null];throw y;case 4:return s.trys.push([4,6,,7]),[4,d(c)];case 5:return v=s.sent(),[3,7];case 6:if(m=s.sent(),t.skipErrors)return[2,null];throw m;case 7:if(b=v.isSymbolicLink(),x=p.isFile()?i.FILE:i.DIRECTORY,!t.showHidden&&"."===l.charAt(0))return[2,""];if(!t.symbolicLinks&&b)return[2,""];if(E=(0,o.extname)(c).replace(".",""),t.extensions&&x===i.FILE&&-1===t.extensions.indexOf(E))return[2,""];if(k=b?">>":x===i.DIRECTORY?"─> ":"── ",w=r+(f===e.length-1?"    ":"│   "),n+=k+l,!t.followLinks&&b||x!==i.DIRECTORY)return[3,15];s.label=8;case 8:return s.trys.push([8,10,,11]),[4,h(c)];case 9:return L=s.sent().map((function(e){return(0,o.resolve)(c,e)})),t.sorted&&(L="boolean"==typeof t.sorted?L.sort():L.sort(t.sorted)),[3,11];case 10:if(I=s.sent(),t.skipErrors)return[2,null];throw I;case 11:return z=n,L.length?[4,g(L,w,t,a+1)]:[3,13];case 12:return R=s.sent(),[3,14];case 13:R="",s.label=14;case 14:n=z+R,s.label=15;case 15:return[2,n]}}))}))})))];case 1:return f.sent().filter((function(e){return!!e})).forEach((function(e,t,n){c+=r+(t===n.length-1?"└"+e:"├"+e)})),[2,c]}}))}))}function L(e,r,t,n){var s="";return t.sorted&&(e=e.sort((function(e,r){return"boolean"==typeof t.sorted?e.relativePath.localeCompare(r.relativePath):t.sorted(e.relativePath,r.relativePath)}))),e.filter((function(e){return!k(e,t,n)})).forEach((function(e,o,a){var c=e.isSymbolicLink?">>":e.type===i.DIRECTORY?"─> ":"── ",l=o===a.length-1?"└"+c:"├"+c,u=r+(o===a.length-1?"    ":"│   ");s+=r+l+e.name,s+=!e.children||!t.followLinks&&e.isSymbolicLink?"":L(e.children,u,t,n+1)})),s}function I(e,r,t,o){return n(this,void 0,void 0,(function(){var n,a,c,l,u,h,f,d,p;return s(this,(function(s){switch(s.label){case 0:n="",t.sorted&&(e=e.sort((function(e,r){return"boolean"==typeof t.sorted?e.relativePath.localeCompare(r.relativePath):t.sorted(e.relativePath,r.relativePath)}))),a=e.filter((function(e){return!k(e,t,o)})),c=0,s.label=1;case 1:return c<a.length?(l=a[c],u=l.isSymbolicLink?">>":l.type===i.DIRECTORY?"─> ":"── ",h=c===a.length-1?"└"+u:"├"+u,f=r+(c===a.length-1?"    ":"│   "),n+=r+h+l.name,d=n,!l.children||!t.followLinks&&l.isSymbolicLink?[3,3]:[4,I(l.children,f,t,o+1)]):[3,6];case 2:return p=s.sent(),[3,4];case 3:p="",s.label=4;case 4:n=d+p,s.label=5;case 5:return c++,[3,1];case 6:return[2,n]}}))}))}r.scan=function(e,r,t,n){var s=(0,o.resolve)(e),i=v(r),a=x(s,s,0,i,t,n);return a&&(a.sizeInBytes=i.sizeInBytes?a.sizeInBytes:void 0),a},r.scanAsync=function(e,r,t,i){return n(this,void 0,void 0,(function(){var n,a,c;return s(this,(function(s){switch(s.label){case 0:return n=(0,o.resolve)(e),a=v(r),[4,E(n,n,0,a,t,i)];case 1:return(c=s.sent())&&(c.sizeInBytes=a.sizeInBytes?c.sizeInBytes:void 0),[2,c]}}))}))},r.parse=function(e,r){var t,n,s="",i=(0,o.resolve)(e),a=m(r);s+=(0,o.basename)(i);try{t=(0,c.statSync)(e)}catch(e){if(a.skipErrors)return null;throw e}try{n=(0,c.lstatSync)(e)}catch(e){if(a.skipErrors)return null;throw e}var l=n.isSymbolicLink();if((a.followLinks||!l)&&t.isDirectory()){var u=void 0;try{u=(0,c.readdirSync)(i).map((function(e){return(0,o.resolve)(i,e)})),a.sorted&&(u="boolean"==typeof a.sorted?u.sort():u.sort(a.sorted))}catch(e){if(a.skipErrors)return null;throw e}s+=u.length?w(u,"\n ",a,1):""}return s},r.parseAsync=function(e,r){return n(this,void 0,void 0,(function(){var t,n,i,a,c,l,f,p,y,v,b,x,E;return s(this,(function(s){switch(s.label){case 0:t="",n=(0,o.resolve)(e),i=m(r),a=(0,o.basename)(n),t+=a,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,u(e)];case 2:return c=s.sent(),[3,4];case 3:if(l=s.sent(),i.skipErrors)return[2,null];throw l;case 4:return s.trys.push([4,6,,7]),[4,d(e)];case 5:return f=s.sent(),[3,7];case 6:if(p=s.sent(),i.skipErrors)return[2,null];throw p;case 7:if(y=f.isSymbolicLink(),!i.followLinks&&y||!c.isDirectory())return[3,15];v=void 0,s.label=8;case 8:return s.trys.push([8,10,,11]),[4,h(n)];case 9:return v=s.sent().map((function(e){return(0,o.resolve)(n,e)})),i.sorted&&(v="boolean"==typeof i.sorted?v.sort():v.sort(i.sorted)),[3,11];case 10:if(b=s.sent(),i.skipErrors)return[2,null];throw b;case 11:return x=t,v.length?[4,g(v,"\n ",i,1)]:[3,13];case 12:return E=s.sent(),[3,14];case 13:E="",s.label=14;case 14:t=x+E,s.label=15;case 15:return[2,t]}}))}))},r.parseTree=function(e,r){var t="",n=m(r);return(t+=e?e.name:"")+(e.children?L(e.children,"\n ",n,1):"")},r.parseTreeAsync=function(e,r){return n(this,void 0,void 0,(function(){var t,n,i,o;return s(this,(function(s){switch(s.label){case 0:return t="",n=m(r),t+=e?e.name:"",i=t,e.children?[4,I(e.children,"\n ",n,1)]:[3,2];case 1:return o=s.sent(),[3,3];case 2:o="",s.label=3;case 3:return[2,t=i+o]}}))}))}},113:e=>{e.exports=require("crypto")},147:e=>{e.exports=require("fs")},17:e=>{e.exports=require("path")},837:e=>{e.exports=require("util")}},r={};return function t(n){var s=r[n];if(void 0!==s)return s.exports;var i=r[n]={exports:{}};return e[n].call(i.exports,i,i.exports,t),i.exports}(183)})()}));